# Modelica2Pyomo

This repository contains [modelica2pyomo.py](./modelica2pyomo.py), a tool to automatically translate Modelica models into Pyomo models.

The Modelica model should be converted into Base Modelica code generated by OpenModelica employing the script [exampleInstantiation.mos](./exampleInstantiation.mos) as a template. The basic flags to generate the right flavour of Base Modelica are already set in the template, you can add more if required, as well as project-specific API calls to load the model and the required libraries. For open-source libraries, it is recommended to use the Package Manager to install them and the uses() annotation, so that they can be loaded automatically.

To obtain the BaseModelica model, run in a terminal window the following command:

```console
omc exampleInstantiation.mos > exampleBaseModelica.mo
```

*modelica2pyomo.py* features a `m2p()` function, which should be executed to generate the *equivalent* Pyomo model.

The file [example.py](./example.py) shows an example of how to call the `m2p()` function and which are the inputs to provide.

The generated Pyomo model employes the [IDAES](https://idaes-pse.readthedocs.io/en/stable/index.html) Python package to employ the optimization solver IPOPT. For this reason, few lines of code to import the idaes package are included in the Pyomo script.

Notice also that the Python packages [numpy](https://numpy.org/), [scipy](https://scipy.org/), [DyMat](https://github.com/jraedler/DyMat) and [regex](https://github.com/mrabarnett/mrab-regex) are required.
